(function () { function a(b, c, d, e, f) { if (this instanceof a) this._ms = 0, b instanceof Date && c instanceof Date ? this._ms = b.getTime() - c.getTime() : typeof b == "number" && (this._ms = b, typeof c == "number" && (this._ms += c * a.second), typeof d == "number" && (this._ms += d * a.minute), typeof e == "number" && (this._ms += e * a.hour), typeof f == "number" && (this._ms += f * a.day)); else return new a(b, c, d, e, f) } a.millisecond = 1, a.second = a.millisecond * 1e3, a.minute = a.second * 60, a.hour = a.minute * 60, a.day = a.hour * 24, a._formatters = { l: "milliseconds", s: "seconds", m: "minutes", h: "hours", d: "days" }, a._formatRegex = /(~\^)|(~l|l+|\^l+)|(~s|s+|\^s+)|(~m|m+|\^m+)|(~h|h+|\^h+)|(~d|d+|\^d+)/g, a._pad = function (a, b) { var c = a.toString(); while (c.length < b) c = "0" + c; return c }, a.prototype._unitName = function (b) { b = b.replace(/s$/, ""); if (typeof a[b] != "number") throw new Error("Invalid unit '" + b + "'"); return b }, a.prototype._unitSize = function (b) { return a[this._unitName(b)] }, a.prototype._getUnits = function () { var b = {}, c = this._ms; return b.days = Math.floor(c / a.day), c %= a.day, b.hours = Math.floor(c / a.hour), c %= a.hour, b.minutes = Math.floor(c / a.minute), c %= a.minute, b.seconds = Math.floor(c / a.second), c %= a.second, b.milliseconds = Math.floor(c / a.millisecond), c %= a.millisecond, b }, a.prototype.total = function (a) { return this.ms === 0 ? 0 : Math.floor(this._ms / this._unitSize(a)) }, a.prototype.get = function (a) { return this._getUnits()[this._unitName(a) + "s"] }, a.prototype.add = function (a, b) { return this._ms += (b || 1) * this._unitSize(a), this }, a.prototype.subtract = function (a, b) { return this.add(a, -(b || 1)) }, a.prototype.format = function (b) { var c = this; return b.replace(a._formatRegex, function (b) { var d = c.get, e; return b.indexOf("~") === 0 ? b.replace("~", "") : (b.indexOf("^") === 0 && (d = c.total, b = b.replace("^", "")), e = a._formatters[b.charAt(0)], a._pad(d.call(c, e), b.length)) }) }, typeof module != "undefined" ? module.exports = a : typeof define != "undefined" && define.amd ? define(function () { return a }) : window.TimeSpan = a })();